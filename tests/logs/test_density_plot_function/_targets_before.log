[2025-04-20 19:04:33] [6] [create_se] --- create_se のロガー設定完了 (PID: 90606) ---
[2025-04-20 19:04:33] [6] [create_se] モジュールログファイルパス: tests/logs/test_density_plot_function/create_se.log
[2025-04-20 19:04:33] [6] [create_se] ログレベル: TRACE
[2025-04-20 19:04:33] [6] [create_se] --- create_se.Rmd の実行開始 ---
[2025-04-20 19:04:33] [6] [create_se] 実験ID: test_density_plot_function
[2025-04-20 19:04:33] [6] [create_se] 入力パラメータ:
[2025-04-20 19:04:33] [9] [create_se] - experiment_id: test_density_plot_function
[2025-04-20 19:04:33] [9] [create_se] - counts_file_path: /home/rstudio/projects/Rmd_targets_RNA-seq/tests/testdata/counts_test.csv
[2025-04-20 19:04:33] [9] [create_se] - metadata_file_path: /home/rstudio/projects/Rmd_targets_RNA-seq/tests/testdata/metadata_test.csv
[2025-04-20 19:04:33] [9] [create_se] - gene_id_column: gene_id
[2025-04-20 19:04:33] [9] [create_se] - sample_id_column: sample_id
[2025-04-20 19:04:33] [9] [create_se] - biomart_host: https://ensembl.org
[2025-04-20 19:04:33] [9] [create_se] - biomart_dataset: hsapiens_gene_ensembl
[2025-04-20 19:04:33] [9] [create_se] - biomart_attributes: ensembl_gene_id, external_gene_name, transcript_length, gene_biotype
[2025-04-20 19:04:33] [6] [create_se] --- 入力ファイルの存在確認開始 ---
[2025-04-20 19:04:33] [8] [create_se] カウントファイル確認OK: /home/rstudio/projects/Rmd_targets_RNA-seq/tests/testdata/counts_test.csv
[2025-04-20 19:04:33] [8] [create_se] メタデータファイル確認OK: /home/rstudio/projects/Rmd_targets_RNA-seq/tests/testdata/metadata_test.csv
[2025-04-20 19:04:33] [6] [create_se] --- 入力ファイルの存在確認完了 ---
[2025-04-20 19:04:33] [6] [create_se] --- 入力ファイルの読み込み開始 ---
[2025-04-20 19:04:33] [8] [create_se] カウントファイル読み込み中: /home/rstudio/projects/Rmd_targets_RNA-seq/tests/testdata/counts_test.csv
[2025-04-20 19:04:33] [6] [create_se] カウントファイルを正常に読み込みました。次元: 2 行 x 3 列
[2025-04-20 19:04:33] [9] [create_se] カウントデータの列名: gene_id, sample1, sample2
[2025-04-20 19:04:33] [8] [create_se] メタデータファイル読み込み中: /home/rstudio/projects/Rmd_targets_RNA-seq/tests/testdata/metadata_test.csv
[2025-04-20 19:04:33] [6] [create_se] メタデータファイルを正常に読み込みました。次元: 2 行 x 2 列
[2025-04-20 19:04:33] [9] [create_se] メタデータの列名: sample_id, condition
[2025-04-20 19:04:33] [6] [create_se] --- 入力ファイルの読み込み完了 ---
[2025-04-20 19:04:33] [9] [create_se] カウントデータの最初の10行を表示します。
[2025-04-20 19:04:33] [9] [create_se] サンプルメタデータの最初の10行を表示します。
[2025-04-20 19:04:33] [6] [create_se] --- データの整合性チェック開始 ---
[2025-04-20 19:04:33] [8] [create_se] 必須列の存在を確認します。
[2025-04-20 19:04:33] [8] [create_se] 必須列の存在確認OK。
[2025-04-20 19:04:33] [8] [create_se] カウントデータとメタデータのサンプルIDの一致を確認します。
[2025-04-20 19:04:33] [9] [create_se] カウントデータのサンプルID (n=2): sample1, sample2...
[2025-04-20 19:04:33] [9] [create_se] メタデータのサンプルID (n=2): sample1, sample2...
[2025-04-20 19:04:33] [6] [create_se] サンプルIDはカウントヘッダーとメタデータ列 'sample_id' で完全に一致します (n=2)。
[2025-04-20 19:04:33] [8] [create_se] メタデータをカウントデータのサンプル順序 ('sample1, sample2') に合わせて並べ替えます。
[2025-04-20 19:04:33] [6] [create_se] サンプルメタデータをカウントデータの列に合わせて並べ替えました。並べ替え後の次元: 2 行 x 2 列
[2025-04-20 19:04:33] [9] [create_se] 並べ替え後のメタデータサンプルID: sample1, sample2...
[2025-04-20 19:04:33] [6] [create_se] --- データの整合性チェック完了 ---
[2025-04-20 19:04:33] [6] [create_se] --- biomaRtによる遺伝子アノテーション取得開始 ---
[2025-04-20 19:04:33] [8] [create_se] カウントマトリックスの準備と遺伝子IDの抽出を行います。
[2025-04-20 19:04:33] [6] [create_se] カウントマトリックスを準備しました。次元: 2 遺伝子, 2 サンプル。
[2025-04-20 19:04:33] [6] [create_se] カウントからのバージョン付き遺伝子IDの総数: 2
[2025-04-20 19:04:33] [9] [create_se] バージョン付き遺伝子ID (一部): ENSG000001, ENSG000002...
[2025-04-20 19:04:33] [8] [create_se] 遺伝子IDからバージョン情報 (例: '.1', '.2') を削除します。
[2025-04-20 19:04:33] [6] [create_se] バージョンを削除しました。biomaRtクエリ用の一意なバージョンなしID: 2 個。
[2025-04-20 19:04:33] [9] [create_se] バージョンなし一意遺伝子ID (一部): ENSG000001, ENSG000002...
[2025-04-20 19:04:33] [6] [create_se] biomaRt ホスト 'https://ensembl.org' のデータセット 'hsapiens_gene_ensembl' に接続します。
[2025-04-20 19:04:33] [6] [create_se] biomaRt に接続しました。
[2025-04-20 19:04:33] [6] [create_se] biomaRt で取得する属性: ensembl_gene_id, external_gene_name, transcript_length, gene_biotype
[2025-04-20 19:04:33] [6] [create_se] biomaRt から 2 個の一意な遺伝子IDに対するアノテーションを取得中です...
[2025-04-20 19:04:33] [6] [create_se] biomaRt から 2 個のアノテーションレコードを正常に取得しました。
[2025-04-20 19:04:33] [9] [create_se] 取得したアノテーションデータの列名: ensembl_gene_id, external_gene_name, transcript_length, gene_biotype
[2025-04-20 19:04:33] [8] [create_se] biomaRt 属性名を標準的な列名に変更します (例: external_gene_name -> gene_name)。
[2025-04-20 19:04:33] [9] [create_se] 列名を変更: 'external_gene_name' -> 'gene_name'
[2025-04-20 19:04:33] [9] [create_se] 列名を変更: 'transcript_length' -> 'gene_length'
[2025-04-20 19:04:33] [8] [create_se] 列名変更後のアノテーション列名: ensembl_gene_id, gene_name, gene_length, gene_biotype
[2025-04-20 19:04:33] [8] [create_se] 取得したアノテーションデータの前処理を行います (重複削除、マッピング)。
[2025-04-20 19:04:33] [8] [create_se] biomaRt 結果に ensembl_gene_id の重複はありませんでした。
[2025-04-20 19:04:33] [8] [create_se] 元のバージョン付き遺伝子ID (2 個) にアノテーション情報をマッピングします。
[2025-04-20 19:04:33] [9] [create_se] 結合キー 'ensembl_gene_id' の型を character に統一します。
[2025-04-20 19:04:33] [9] [create_se] annotation_unique の ensembl_gene_id を character に変換しました。型: character
[2025-04-20 19:04:33] [9] [create_se] マッピング用データフレームの次元: 2行 x 2列
[2025-04-20 19:04:33] [9] [create_se] アノテーションユニークデータの次元: 2行 x 4列
[2025-04-20 19:04:33] [9] [create_se] left_join 後の結果データフレームの次元: 2行 x 5列
[2025-04-20 19:04:33] [9] [create_se] left_join 後の結果データフレームの列名: original_id, ensembl_gene_id, gene_name, gene_length, gene_biotype
[2025-04-20 19:04:33] [9] [create_se] rowdata_df の最終次元: 2行 x 4列
[2025-04-20 19:04:33] [9] [create_se] rowdata_df の列名: ensembl_gene_id, gene_name, gene_length, gene_biotype
[2025-04-20 19:04:33] [6] [create_se] アノテーションのマッピング完了。rowData の次元: 2 行, 4 列。
[2025-04-20 19:04:33] [6] [create_se] biomaRt アノテーション結果に NA はありませんでした。
[2025-04-20 19:04:33] [8] [create_se] rowData を S4Vectors::DataFrame に変換します。
[2025-04-20 19:04:33] [6] [create_se] アノテーションを rowData 用の DataFrame にフォーマットしました。次元: 2 行, 4 列。
[2025-04-20 19:04:33] [9] [create_se] rowData (DataFrame) の列名: ensembl_gene_id, gene_name, gene_length, gene_biotype
[2025-04-20 19:04:33] [8] [create_se] 最終チェック: カウントマトリックスと rowData の行名は一致します。
[2025-04-20 19:04:33] [6] [create_se] --- biomaRtによる遺伝子アノテーション取得完了 ---
[2025-04-20 19:04:33] [6] [create_se] --- SummarizedExperiment オブジェクト作成開始 ---
[2025-04-20 19:04:33] [8] [create_se] SummarizedExperiment オブジェクトを作成します。入力データサイズ: (counts: 2 x 2, colData: 2 x 2, rowData: 2 x 4)
[2025-04-20 19:04:33] [9] [create_se] colData用のDataFrameを準備します。サンプルID列名: sample_id
[2025-04-20 19:04:33] [9] [create_se] colData用のDataFrameの行名を設定しました: sample1, sample2
[2025-04-20 19:04:33] [6] [create_se] SummarizedExperiment オブジェクトを正常に作成しました。
[2025-04-20 19:04:33] [8] [create_se] SE オブジェクトのクラス: SummarizedExperiment
[2025-04-20 19:04:33] [8] [create_se] SE オブジェクトの次元: 2 features, 2 samples
[2025-04-20 19:04:33] [8] [create_se] SE assay 名: counts
[2025-04-20 19:04:33] [8] [create_se] SE colData 列名: sample_id, condition
[2025-04-20 19:04:33] [8] [create_se] SE rowData 列名: ensembl_gene_id, gene_name, gene_length, gene_biotype
[2025-04-20 19:04:33] [6] [create_se] SE オブジェクトのメタデータに実験情報とパイプライン履歴を記録します。
[2025-04-20 19:04:33] [6] [create_se] SE メタデータに pipeline_history['create_se'] を記録しました。
[2025-04-20 19:04:33] [6] [create_se] --- SummarizedExperiment オブジェクト作成完了 ---
[2025-04-20 19:04:33] [6] [create_se] 実験 'test_density_plot_function' の SummarizedExperiment オブジェクト作成プロセスが正常に完了しました。
[2025-04-20 19:04:33] [8] [create_se] assaysの一部を表示します
[2025-04-20 19:04:33] [8] [create_se] colDataの一部を表示します
[2025-04-20 19:04:33] [8] [create_se] rowDataの一部を表示します
[2025-04-20 19:04:33] [6] [create_se] gene_biotypeの分布を集計・可視化します
[2025-04-20 19:04:33] [8] [create_se] gene_biotypeの分布をバープロットで可視化します
[2025-04-20 19:04:35] [6] [create_se] protein_coding遺伝子に関する詳細分析を行います
[2025-04-20 19:04:35] [6] [create_se] protein_coding遺伝子数: 2 / 2 遺伝子 (100.00%)
[2025-04-20 19:04:35] [8] [create_se] protein_coding遺伝子のアノテーション欠損状況を確認します
[2025-04-20 19:04:35] [6] [create_se] protein_coding遺伝子のアノテーションに欠損はありません
[2025-04-20 19:04:35] [6] [create_se] サンプルごとのprotein_coding遺伝子のライブラリサイズを比較します
[2025-04-20 19:04:35] [6] [create_se] --- plot_protein_coding_library_size 関数を実行します ---
[2025-04-20 19:04:35] [8] [create_se] サンプルごとのprotein_coding遺伝子のライブラリサイズをバープロットで可視化します
[2025-04-20 19:04:35] [6] [create_se] --- plot_protein_coding_library_size 関数の実行完了 ---
[2025-04-20 19:04:36] [6] [create_se] --- サンプル間の発現量分布を比較します ---
[2025-04-20 19:04:36] [8] [create_se] 生データの発現量分布プロットを作成します
[2025-04-20 19:04:36] [6] [create_se] --- plot_expression_density 関数を実行します ---
[2025-04-20 19:04:36] [8] [create_se] パラメータ: log_transform=FALSE, pseudo_count=1.000000, assay_name=counts, adjust=1.500000
[2025-04-20 19:04:36] [8] [create_se] カウント行列の次元: 2 x 2
[2025-04-20 19:04:36] [8] [create_se] ロング形式データの次元: 4 x 2
[2025-04-20 19:04:36] [8] [create_se] 外れ値除外のための上限値: 24.850000 (99 %)
[2025-04-20 19:04:36] [6] [create_se] --- plot_expression_density 関数の実行完了 ---
[2025-04-20 19:04:36] [8] [create_se] log2変換後の発現量分布プロットを作成します
[2025-04-20 19:04:36] [6] [create_se] --- plot_expression_density 関数を実行します ---
[2025-04-20 19:04:36] [8] [create_se] パラメータ: log_transform=TRUE, pseudo_count=1.000000, assay_name=counts, adjust=1.500000
[2025-04-20 19:04:36] [8] [create_se] カウント行列の次元: 2 x 2
[2025-04-20 19:04:36] [9] [create_se] サンプル sample1 の非ゼロカウント数: 2 (全 2 中)
[2025-04-20 19:04:36] [9] [create_se] サンプル sample2 の非ゼロカウント数: 2 (全 2 中)
[2025-04-20 19:04:36] [8] [create_se] ロング形式データの次元: 4 x 2
[2025-04-20 19:04:36] [6] [create_se] --- plot_expression_density 関数の実行完了 ---
[2025-04-20 19:04:36] [8] [create_se] サンプルごとの発現量分布の統計情報を計算します
